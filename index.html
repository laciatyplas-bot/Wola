
  </nav>
</div>

<script>
/* -----------------------
   ZMIENNE UI I JÄ˜ZYK
   ----------------------- */
let currentLang = 'pl';
const UI_TEXT = {
  pl:{
    title:'MAPA ETERNIVERSE',
    intro:'Centralny interfejs Architekta. Wyszukaj, filtruj, zarzÄ…dzaj stanem. Kliknij na tytuÅ‚, aby zobaczyÄ‡ szczegÃ³Å‚y, statusy i notatki marketingowe.',
    searchPlaceholder:'Szukaj: tytuÅ‚, tag, opis...',
    expand:'RozwiÅ„', collapse:'ZwiÅ„',
    filterAll:'Wszystkie bramy', filter1:'Brama 1 (Inter)', filter2:'Brama 2 (Eter)', filter3:'Brama 3 (Obfito)', filter4:'Brama 4 (Knot)', filter5:'Brama 5 (Quantum)',
    exportJson:'ðŸ“¥ Eksport JSON',
    status:{ idea:'pomysÅ‚', draft:'szkic', writing:'w pisaniu', published:'opublikowana', ready:'gotowa do druku', final_ready:'final ready' }
  },
  en:{
    title:'ETERNIVERSE MAP',
    intro:'Central Architect Interface. Search, filter, manage state. Click title to see details, status and marketing notes.',
    searchPlaceholder:'Search...',
    expand:'Expand', collapse:'Collapse',
    filterAll:'All Gates', filter1:'Gate 1 (Inter)', filter2:'Gate 2 (Eter)', filter3:'Gate 3 (Obfito)', filter4:'Gate 4 (Knot)', filter5:'Gate 5 (Quantum)',
    exportJson:'ðŸ“¥ Export JSON',
    status:{ idea:'idea', draft:'draft', writing:'writing', published:'published', ready:'ready to print', final_ready:'final ready' }
  }
};

/* -----------------------
   MASTER JSON (wklejone)
   ----------------------- */
const MASTER_JSON = {
  "generated_at": "2025-12-08T18:19:36.850Z",
  "map_data": [
    {
      "id": "brama1",
      "class": "brama1",
      "name": { "pl": "BRAMA 1 â€” INTERSEEKER", "en": "GATE 1 â€” INTERSEEKER" },
      "color": "var(--teal)",
      "sub": { "pl": "Psychika Â· Trauma Â· CieÅ„ Â· Archetyp", "en": "Psyche Â· Trauma Â· Shadow Â· Archetype" },
      "books": [
        {
          "title": { "pl": "INTERSEEKER: Geneza", "en": "INTERSEEKER: Geneza" },
          "status": "ready",
          "tags": { "pl": [ "autobiografia", "ogien", "trauma", "geneza" ], "en": [] },
          "desc": { "pl": "Historia 'spod pieca'. DzieciÅ„stwo na bagnach, oÅ›rodek, walka z cieniem. Fundament, na ktÃ³rym stoi caÅ‚a reszta. To 'Origin Story' Architekta.", "en": "" },
          "notes": "Gotowa czÄ™Å›Ä‡ autobiograficzna (OgieÅ„ wybraÅ‚ Macieja). Opublikowana czÄ™Å›ciowo na Wattpad."
        },
        {
          "title": { "pl": "InterSeeker â€“ Atlas WewnÄ™trzny", "en": "InterSeeker â€“ Atlas WewnÄ™trzny" },
          "status": "published",
          "tags": { "pl": [ "psychika", "cieÅ„", "wattpad" ], "en": [ "seeker" ] },
          "desc": { "pl": "PodrÄ™cznik nawigacji w ciemnoÅ›ci. 17 opublikowanych czÄ™Å›ci na Wattpad. #3 w rankingu Interseeker.", "en": "Entry into the shadow: a compact atlas of the psyche." },
          "notes": "Zawiera rozdziaÅ‚y o walce z Cieniem. DziaÅ‚a jako wstÄ™p do pracy wÅ‚asnej."
        },
        {
          "title": { "pl": "BioSeeker â€“ Sekret Biologii Pola", "en": "BioSeeker â€“ Sekret Biologii Pola" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "NaukoSeeker â€“ Mechanika Pola", "en": "NaukoSeeker â€“ Mechanika Pola" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "ObfitoSeeker II â€“ Kod Rozszerzony", "en": "ObfitoSeeker II â€“ Kod Rozszerzony" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "RytmSeeker â€“ Mechanika Ruchu Å»ycia", "en": "RytmSeeker â€“ Mechanika Ruchu Å»ycia" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "CzasSeeker â€“ Fizyka Linii Czasu", "en": "CzasSeeker â€“ Fizyka Linii Czasu" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Geneza", "en": "Geneza" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Tom zero â€” ustawienia nukleusowe uniwersum: poczÄ…tki logiki pola.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Kronika Woli", "en": "Kronika Woli" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Wola jako mechanika kwantowa. CieÅ„ jako test. Jedna ksiÄ™ga Å‚Ä…czÄ…ca autobiografiÄ™, protokoÅ‚y i praktykÄ™ przebudzenia.", "en": "Chronicle of Will. Will as quantum mechanics. Shadow as a test." },
          "notes": ""
        },
        {
          "title": { "pl": "Archetypy Eteru â€” Tom 2", "en": "Archetypy Eteru â€” Tom 2" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Mapa Trajektorii Å»ycia (rozszerzona)", "en": "Mapa Trajektorii Å»ycia (rozszerzona)" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "EterWar", "en": "EterWar" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        }
      ]
    },
    {
      "id": "brama2",
      "class": "brama2",
      "name": { "pl": "BRAMA 2 â€” ETERSEEKER", "en": "GATE 2 â€” ETERSEEKER" },
      "color": "var(--gold)",
      "sub": { "pl": "Wola Â· Pole Â· Architektura rzeczywistoÅ›ci", "en": "Will Â· Field Â· Architecture of Reality" },
      "books": [
        {
          "title": { "pl": "ShadowSeeker â€“ Anatomia Cienia", "en": "ShadowSeeker â€“ Anatomia Cienia" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "BÃ³lSeeker â€“ Anatomia Rany", "en": "BÃ³lSeeker â€“ Anatomia Rany" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "InterfejsSeeker â€“ Interfejs ÅšwiadomoÅ›ci", "en": "InterfejsSeeker â€“ Interfejs ÅšwiadomoÅ›ci" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "MateriaSeeker â€“ Przewodnik CiaÅ‚a i PrzepÅ‚ywu", "en": "MateriaSeeker â€“ Przewodnik CiaÅ‚a i PrzepÅ‚ywu" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "ConscienceSeeker â€“ Kartografia Sumienia", "en": "ConscienceSeeker â€“ Kartografia Sumienia" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "PoleSeeker â€“ Topologia Ludzkiego Pola", "en": "PoleSeeker â€“ Topologia Ludzkiego Pola" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "EterSeeker â€“ KsiÄ™ga Zakazana (Tom Zero)", "en": "EterSeeker â€“ KsiÄ™ga Zakazana (Tom Zero)" },
          "status": "writing",
          "tags": { "pl": [ "tartaria", "zakazana_wiedza", "reset" ], "en": [ "seeker" ] },
          "desc": { "pl": "Cisza przed bÅ‚otem. Historia resetÃ³w cywilizacji i ukrytej technologii eteru.", "en": "Description pending." },
          "notes": "Czarny PDF, tylko tekst, bez ozdobnikÃ³w. Dla wtajemniczonych."
        },
        {
          "title": { "pl": "Kronika Obserwatora", "en": "Kronika Obserwatora" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Archetypy Eteru â€” Tom 3", "en": "Archetypy Eteru â€” Tom 3" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Esker / Eskiera", "en": "Esker / Eskiera" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "MetaGeneza", "en": "MetaGeneza" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        }
      ]
    },
    {
      "id": "brama3",
      "class": "brama3",
      "name": { "pl": "BRAMA 3 â€” OBFITOSEEKER", "en": "GATE 3 â€” OBFITOSEEKER" },
      "color": "var(--green)",
      "sub": { "pl": "Materia Â· Transformacja Â· ObfitoÅ›Ä‡", "en": "Matter Â· Transformation Â· Abundance" },
      "books": [
        {
          "title": { "pl": "Fito-Seeker", "en": "Fito-Seeker" },
          "status": "draft",
          "tags": { "pl": [ "zdrowie", "biologia", "natura" ], "en": [] },
          "desc": { "pl": "CzÅ‚owiek, ktÃ³ry zaczyna rosnÄ…Ä‡. PoÅ‚Ä…czenie pracy z ciaÅ‚em, dietÄ… i naturÄ….", "en": "" },
          "notes": "OkÅ‚adka gotowa (postaÄ‡ z roÅ›linÄ…)."
        },
        {
          "title": { "pl": "MemorySeeker â€“ Archeologia WspomnieÅ„", "en": "MemorySeeker â€“ Archeologia WspomnieÅ„" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "EterSeeker â€“ Architektura Woli", "en": "EterSeeker â€“ Architektura Woli" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Schematy kreacji rzeczywistoÅ›ci â€” krÃ³tko, projektowo, efektywnie.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "SplatanieSeeker â€“ ProtokÃ³Å‚ Obserwatora", "en": "SplatanieSeeker â€“ ProtokÃ³Å‚ Obserwatora" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Mutoseeker â€“ Kod Mutacji", "en": "Mutoseeker â€“ Kod Mutacji" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "ArchetypSeeker â€“ System ArchetypÃ³w Eteru", "en": "ArchetypSeeker â€“ System ArchetypÃ³w Eteru" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "SenSeeker â€“ Mechanika SnÃ³w", "en": "SenSeeker â€“ Mechanika SnÃ³w" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Eteriony â€“ Tom I", "en": "Eteriony â€“ Tom I" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "KsiÄ™ga PrzepÅ‚ywu", "en": "KsiÄ™ga PrzepÅ‚ywu" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Atlas Ludzi Ognia", "en": "Atlas Ludzi Ognia" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Esker: CzÄ…stka, ktÃ³ra patrzy z powrotem", "en": "Esker: CzÄ…stka, ktÃ³ra patrzy z powrotem" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Custos: Kodeks GÅ‚Ä™bi", "en": "Custos: Kodeks GÅ‚Ä™bi" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        }
      ]
    },
    {
      "id": "brama4",
      "class": "brama4",
      "name": { "pl": "BRAMA 4 â€” THE KNOT", "en": "GATE 4 â€” THE KNOT" },
      "color": "var(--purple)",
      "sub": { "pl": "Technologia Â· SplÄ…tanie Â· ProtokÃ³Å‚", "en": "Technology Â· Entanglement Â· Protocol" },
      "books": [
        {
          "title": { "pl": "SelfSplit Seeker â€“ Rozszczepienie ToÅ¼samoÅ›ci", "en": "SelfSplit Seeker â€“ Rozszczepienie ToÅ¼samoÅ›ci" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "EterSeeker â€“ KsiÄ™ga Woli", "en": "EterSeeker â€“ KsiÄ™ga Woli" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Zestaw zasad i praktyk, ktÃ³re przeksztaÅ‚cajÄ… intencjÄ™ w dziaÅ‚anie pola.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "QuantumSeeker â€“ Fizyka Duszy", "en": "QuantumSeeker â€“ Fizyka Duszy" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "TrajektoriaSeeker â€“ Mapa Linii Å»ycia", "en": "TrajektoriaSeeker â€“ Mapa Linii Å»ycia" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "ZwierzSeeker â€“ Atlas ZwierzÄ…t Eterycznych", "en": "ZwierzSeeker â€“ Atlas ZwierzÄ…t Eterycznych" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "FuturSeeker â€“ PrzyszÅ‚oÅ›Ä‡, ktÃ³ra nadchodzi", "en": "FuturSeeker â€“ PrzyszÅ‚oÅ›Ä‡, ktÃ³ra nadchodzi" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Eteriony â€“ Tom II", "en": "Eteriony â€“ Tom II" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "CiaÅ‚o jako Interfejs Pola", "en": "CiaÅ‚o jako Interfejs Pola" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Kod Ludzi Przebudzonych", "en": "Kod Ludzi Przebudzonych" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Shiker / Shikera", "en": "Shiker / Shikera" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Architekt Eteru â€” Manifest TwÃ³rcy", "en": "Architekt Eteru â€” Manifest TwÃ³rcy" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Manifest i reguÅ‚y twÃ³rcy systemu â€” zobowiÄ…zania, metody, etyka.", "en": "Description pending." },
          "notes": ""
        }
      ]
    },
    {
      "id": "brama5",
      "class": "brama5",
      "name": { "pl": "BRAMA 5 â€” QUANTUM KNOT", "en": "GATE 5 â€” QUANTUM KNOT" },
      "color": "var(--orange)",
      "sub": { "pl": "Kwanta Â· Entropia Â· Nowe trajektorie", "en": "Quanta Â· Entropy Â· New trajectories" },
      "books": [
        {
          "title": { "pl": "ReligioSeeker â€“ Droga Bez Religii", "en": "ReligioSeeker â€“ Droga Bez Religii" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "WolaSeeker â€“ Kwant Woli", "en": "WolaSeeker â€“ Kwant Woli" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "ObfitoSeeker â€“ Kod ObfitoÅ›ci", "en": "ObfitoSeeker â€“ Kod ObfitoÅ›ci" },
          "status": "published",
          "tags": { "pl": [ "pieniÄ…dze", "przepÅ‚yw", "ojciec", "syn" ], "en": [ "seeker" ] },
          "desc": { "pl": "Kod, ktÃ³ry nie mÃ³wi o pieniÄ…dzach â€” mÃ³wi o reguÅ‚ach gry. Historia powrotu do syna. 19 opublikowanych czÄ™Å›ci na Wattpadzie.", "en": "Abundance Code: practical protocol for resource transformation." },
          "notes": "NajwaÅ¼niejsza czÄ™Å›Ä‡ 'dla Nikosia'. OkÅ‚adka z ojcem i synem. Status #1 w rankingu 'Start Tutaj'."
        },
        {
          "title": { "pl": "DrogaSeeker â€“ Kod Przemiany CzÅ‚owieka", "en": "DrogaSeeker â€“ Kod Przemiany CzÅ‚owieka" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "PustkaSeeker â€“ Kartografia Ciszy", "en": "PustkaSeeker â€“ Kartografia Ciszy" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "OjciecSeeker â€“ Architektura Relacji Ojciecâ€“Dziecko", "en": "OjciecSeeker â€“ Architektura Relacji Ojciecâ€“Dziecko" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Praca z relacjÄ… rodzicâ€“dziecko: energetyczne wzory i protokoÅ‚y naprawy.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "ProtokÃ³Å‚ SplÄ…tania (wersja meta)", "en": "ProtokÃ³Å‚ SplÄ…tania (wersja meta)" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Archetypy Eteru â€” Tom 1", "en": "Archetypy Eteru â€” Tom 1" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Mapa Uniwersum Eteru", "en": "Mapa Uniwersum Eteru" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Funkcja, ktÃ³ra zmienia Å›wiat", "en": "Funkcja, ktÃ³ra zmienia Å›wiat" },
          "status": "idea",
          "tags": { "pl": [ "seeker" ], "en": [ "seeker" ] },
          "desc": { "pl": "Opis w przygotowaniu.", "en": "Description pending." },
          "notes": ""
        },
        {
          "title": { "pl": "Janowice â€“ UÅ›miech Architekta", "en": "Janowice â€“ UÅ›miech Architekta" },
          "status": "writing",
          "tags": { "pl": [ "trauma", "zÄ™by", "odwaga", "lÄ™k" ], "en": [ "seeker" ] },
          "desc": { "pl": "PodrÄ™cznik odwagi cywilnej. Historia walki z paraliÅ¼ujÄ…cym lÄ™kiem przed dentystÄ… i odzyskania uÅ›miechu po 4 latach. Kryptonim 'Operacja UÅ›miech'.", "en": "Description pending." },
          "notes": "Lead Magnet. Najbardziej ludzka i intymna czÄ™Å›Ä‡ sagi."
        }
      ]
    }
  ],
  "meta": {
    "assets": { "audio": [ "200k sÅ‚Ã³w nagranych" ], "covers": [ "40+ okÅ‚adek premium" ] },
    "launch_plan": "ZbiÃ³rka na 'WolnoÅ›Ä‡ CzasowÄ…' i 'UÅ›miech'. Publikacja sagi na Amazon KDP."
  }
};

/* -----------------------
   MAPA I META (referencje)
   ----------------------- */
let MAP_DATA = MASTER_JSON.map_data;
let GLOBAL_META = MASTER_JSON.meta;

/* -----------------------
   RENDER / UI
   ----------------------- */

function createBookElement(book){
  const li = document.createElement('li');
  li.className = 'book';
  const top = document.createElement('div'); top.className = 'book-top';
  const title = document.createElement('div'); title.className = 'book-title';
  title.textContent = (book.title && (book.title[currentLang] || book.title.pl)) || 'Untitled';
  const statusSpan = document.createElement('span'); statusSpan.className = 'status-pill status-' + (book.status || 'idea');
  const dot = document.createElement('span'); dot.className = 'status-dot';
  const label = document.createElement('span');
  const statusDict = UI_TEXT[currentLang].status;
  label.textContent = statusDict[book.status] || book.status || '';
  statusSpan.appendChild(dot); statusSpan.appendChild(label);
  top.appendChild(title); top.appendChild(statusSpan);
  li.appendChild(top);
  const tagsEl = document.createElement('div'); tagsEl.className = 'tags';
  const tagList = (book.tags && (book.tags[currentLang] || book.tags.pl)) || [];
  tagsEl.textContent = tagList.length > 0 ? '#' + tagList.join(' #') : '';
  li.appendChild(tagsEl);
  const descEl = document.createElement('div'); descEl.className = 'desc';
  let descText = (book.desc && (book.desc[currentLang] || book.desc.pl)) || '';
  if(book.notes) { descText += `<br><br><strong>NOTATKI ARCHITEKTA:</strong> ${book.notes}`; }
  descEl.innerHTML = descText;
  li.appendChild(descEl);
  li.addEventListener('click', () => li.classList.toggle('open'));
  return li;
}

function createBramaCard(brama){
  const article = document.createElement('article');
  article.id = brama.id;
  article.className = 'brama-card ' + (brama.class || '');
  const headerArea = document.createElement('div'); headerArea.className = 'brama-header-area';
  const title = document.createElement('h2'); title.className = 'brama-title';
  title.textContent = (brama.name && (brama.name[currentLang] || brama.name.pl)) || brama.id;
  const sub = document.createElement('div'); sub.className = 'brama-sub';
  sub.textContent = (brama.sub && (brama.sub[currentLang] || brama.sub.pl)) || '';
  headerArea.appendChild(title); headerArea.appendChild(sub); article.appendChild(headerArea);
  const ul = document.createElement('ul'); ul.className = 'book-list';
  (brama.books || []).forEach(b => { ul.appendChild(createBookElement(b)); });
  article.appendChild(ul);
  return article;
}

function rebuildMap(){
  const grid = document.getElementById('mapGrid');
  grid.innerHTML = '';
  MAP_DATA.forEach(br => { grid.appendChild(createBramaCard(br)); });
  refreshUITexts();
  applyFilters();
}

function applyFilters(){
  const searchVal = document.getElementById('search').value.toLowerCase();
  const filterVal = document.getElementById('filterBrama').value;
  MAP_DATA.forEach(br => {
    const card = document.getElementById(br.id);
    if(!card) return;
    if(filterVal !== 'all' && filterVal !== br.id){ card.style.display = 'none'; return; }
    let visibleBooks = 0;
    const bookEls = card.querySelectorAll('.book');
    bookEls.forEach((el, idx) => {
      const book = br.books[idx];
      const t = ((book.title && (book.title[currentLang] || book.title.pl)) || '').toLowerCase();
      const d = ((book.desc && (book.desc[currentLang] || book.desc.pl)) || '').toLowerCase();
      const tag = (((book.tags && (book.tags[currentLang] || book.tags.pl)) || []).join(' ')).toLowerCase();
      if(t.includes(searchVal) || d.includes(searchVal) || tag.includes(searchVal)){ el.style.display = ''; visibleBooks++; }
      else el.style.display = 'none';
    });
    card.style.display = visibleBooks > 0 ? '' : 'none';
  });
}

function refreshUITexts(){
  const t = UI_TEXT[currentLang];
  document.getElementById('titleMain').textContent = t.title;
  document.getElementById('introText').textContent = t.intro;
  document.getElementById('search').placeholder = t.searchPlaceholder;
  document.getElementById('expandAll').textContent = t.expand;
  document.getElementById('collapseAll').textContent = t.collapse;
  document.getElementById('exportJson').textContent = t.exportJson;
  const sel = document.getElementById('filterBrama');
  sel.options[0].text = t.filterAll;
  sel.options[1].text = t.filter1;
  sel.options[2].text = t.filter2;
  sel.options[3].text = t.filter3;
  sel.options[4].text = t.filter4;
  sel.options[5].text = t.filter5;
}

function exportJson(){
  const exportObj = { generated_at: new Date().toISOString(), map_data: MAP_DATA, meta: GLOBAL_META };
  const dataStr = JSON.stringify(exportObj, null, 2);
  const blob = new Blob([dataStr], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = 'eterniverse_master_data.json';
  document.body.appendChild(a); a.click(); document.body.removeChild(a);
}

function scrollToId(id){ const el = document.getElementById(id); if(el) el.scrollIntoView({behavior:'smooth', block:'start'}); }

/* -----------------------
   EVENTS
   ----------------------- */
document.addEventListener('DOMContentLoaded', () => {
  rebuildMap();
  document.getElementById('search').addEventListener('input', applyFilters);
  document.getElementById('filterBrama').addEventListener('change', applyFilters);
  document.getElementById('langSwitch').addEventListener('change', (e) => { currentLang = e.target.value; rebuildMap(); });
  document.getElementById('expandAll').addEventListener('click', () => document.querySelectorAll('.book').forEach(b => b.classList.add('open')));
  document.getElementById('collapseAll').addEventListener('click', () => document.querySelectorAll('.book').forEach(b => b.classList.remove('open')));
  document.getElementById('exportJson').addEventListener('click', exportJson);
  document.getElementById('toTop').addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));
  document.querySelectorAll('nav