<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BELLA · ROZDZIAŁY (EDYCJA + ZAPIS)</title>

<style>
body{
  margin:0;
  background:#050510;
  color:#e0ffff;
  font-family:system-ui,sans-serif;
}
header{
  padding:14px;
  background:#070720;
  border-bottom:2px solid #00ffff;
  font-weight:700;
  text-align:center;
}
main{padding:12px}
textarea{
  width:100%;
  min-height:30vh;
  background:#0a0a25;
  color:#e0ffff;
  border:none;
  padding:12px;
  font-size:15px;
  line-height:1.6;
}
button{
  width:100%;
  padding:14px;
  margin-top:10px;
  font-size:16px;
  font-weight:700;
  background:#00ffff;
  color:#000;
  border:none;
}
.list button{
  width:100%;
  margin-top:6px;
  background:#000;
  color:#00ffff;
}
#editor{
  min-height:40vh;
  background:#000;
  padding:12px;
  margin-top:10px;
  white-space:pre-wrap;
}
</style>
</head>

<body>

<header>BELLA · ROZDZIAŁY</header>

<main>

<textarea id="input">
Wklej TU całą książkę.
</textarea>

<button onclick="splitAndSave()">PODZIEL I ZAPISZ</button>

<div class="list" id="chapterList"></div>

<h3>EDYCJA ROZDZIAŁU</h3>
<div id="editor" contenteditable="true"></div>

<button onclick="saveChapter()">ZAPISZ ROZDZIAŁ</button>

</main>

<script>
let chapters=[];
let activeIndex=null;

function splitAndSave(){
  const text=document.getElementById('input').value.trim();
  if(!text) return;

  chapters=text.split(/(?=ROZDZIAŁ|Rozdział|CHAPTER|Chapter|KAPITEL|Kapitel)/g)
    .filter(t=>t.trim().length>50);

  localStorage.setItem('BELLA_CHAPTERS',JSON.stringify(chapters));
  renderList();
}

function renderList(){
  const list=document.getElementById('chapterList');
  list.innerHTML='';
  chapters.forEach((c,i)=>{
    const b=document.createElement('button');
    b.textContent='ROZDZIAŁ '+(i+1);
    b.onclick=()=>openChapter(i);
    list.appendChild(b);
  });
}

function openChapter(i){
  activeIndex=i;
  document.getElementById('editor').innerText=chapters[i];
}

function saveChapter(){
  if(activeIndex===null) return;
  chapters[activeIndex]=document.getElementById('editor').innerText;
  localStorage.setItem('BELLA_CHAPTERS',JSON.stringify(chapters));
}

(function load(){
  const saved=localStorage.getItem('BELLA_CHAPTERS');
  if(saved){
    chapters=JSON.parse(saved);
    renderList();
  }
})();
</script>

</body>
</html>